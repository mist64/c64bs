10000 SYS7*4096:.OPT OO

10005 *=$33C:Z0 =$FC:Z1 =$FE

10010 LDY #0:STY Z0:LDX #$20

10020 LDA #$E0:STA Z0+1

10040 L1 LDA (Z0),Y:STA (Z0),Y

10050 INY:BNE L1:INC Z0+1

10060 DEX:BNE L1

10070 LDA #$A0:STA Z0+1:LDX #$20

10080 L2 LDA (Z0),Y:STA (Z0),Y

10090 INY:BNE L2:INC Z0+1

10092 DEX:BNE L2:RTS

10099 .END

10100 SYS828:CLR:REM LABELS LOESCHEN

10105 REM ****************************

10110 SYS7*4096:.OPT OO

11000 FLAG =$0298:FF =255

11010 SERI2 =$029B:SERI1 =$029C

11020 SERO2 =$029E:SERO1 =$029D

11030 SERST =$0297

11040 MAP  =$0299

11050 BLNKT =$0313

11060 BLNK1 =$02BE

11070 BLNK2 =$02BF

11090 UART =$D600

11091 RBR =0:THR =0:IER =1:IIR =2:FCR =2

11092 LCR =3:MCR =4:ULSR =5:MSR =6:SCR =7

11093 DLL =0:DLH =1

11100 MIKE  =0

12000 .IF MIKE-1:.GOTO 12600

12100 *=$ECD9:BC .BYT 11,0

12110 *=$E535:.BYT 15

12120 TPI =$D500

12130 RTSB =4

12500 .GOTO 12999

12600 TPI =$DF00

12610 BC =$ECD9

12999 ;

19999 ;********************************

20000 ;--------------------------------

20005 ;AENDERUNGEN AM ROM

20010 ;--------------------------------

20045 ;FARBE FUER CLR/HOME HINTERGRUND

20050 *=$E4DA : LDA $0286

20060 *=$EB1C : LDY #3; CURSOR SPEED

20070 *=$FF7D : JMP NRESET; CLKHI BEI CONT UND RS232 INIT

21000 ;********************************

21005 ;--------------------------------

21010 ;        RS 232 PER ACIA

21020 ;--------------------------------

21021 ; BELEGT     $F014-$F0AC

21022 ;            $F409-$F49D

21023 ;--------------------------------

21024 .IF MIKE:SERTS =TPI+2

21030 ;-------OPEN

21040 *=$F409: RSOPEN

21050 LDY #0:STY SERST:RS0 CPY $B7

21060 BEQ RS1:LDA ($BB),Y:STA $0293,Y

21070 INY:CPY #$04:BNE RS0

21080 RS1 LDA $0293:AND #15:ASL:SEI

21081 TAY:LDA #%10000000:STA UART+LCR

21082 LDA DIV,Y:STA UART+DLL

21083 LDA DIV+1,Y:STA UART+DLH

21084 LDA $0293:EOR #$60:ROL:ROL:ROL

21085 ROL:AND #%00000111:STA UART+LCR:LDA $0294:LSR:LSR

21086 AND #%00111000:ORA UART+LCR

21087 STA UART+LCR

21088 LDA #7:STA UART+FCR

21089 LDA #3:STA UART+MCR:STA UART+IER

21130 LDA #0:STA $02A1:CLI

21140 JSR $FE27:LDA $F8:BNE RS2:DEY

21150 STY $F8:STX $F7

21160 RS2 LDA $FA:BNE RS3:DEY

21170 STY $FA:STX $F9

21180 RS3 SEC:LDA #$F0:JMP $FE2D

21190 ;-------- RESET

21200 NRESET JSR FRESET

21210 RSRESET LDA #0:STA UART+MCR

21215 STA UART+IER:RTS

21220 ;-------- BASIN

21230 RSBASIN LDA SERST:LDY SERI1

21240 CPY SERI2:BNE RSBIE2

21241 ORA #$08:JMP RXX1A

21242 ;STA SERST:;LDA #0:;RTS

21245 RSBIE2 JMP RXX1:NOP

21335 ;F49E

21340 ;-------- CLOSE

21350 *=$F2AF:JSR RSRESET

21360 *=$F2C5:JMP RS3

21370 ;-------- CHKIN

21380 *=$F227:JMP RSCHKIN

21390 ;-------- CHKOUT

21400 *=$F26C:JMP RSCKOUT

21410 ;-------- BSOUT

21420 *=$F014:NOP:NOP:NOP

21430 RSBSOUT LDY SERO2:INY:CPY SERO1

21440 BEQ RSBSOUT:STY SERO2:DEY

21450 LDA $9E:STA ($F9),Y:CRTS CLC:RTS

21460 ;-------- IRQ

21470 RSIR1 LDA UART+IIR:LSR:BCS IRQE

21472 INTR AND #%00000011:TAY:BNE INTTX

21473 LDA UART+MSR:JMP CHECKINT

21474 INTTX DEY:BNE INTRX

21475 JSR TX2:JMP CHECKINT

21476 INTRX DEY:BNE INTST

21477 RXLOOP JSR RX2:LDA UART+ULSR

21478 LSR:BCS RXLOOP:JMP CHECKINT

21479 INTST LDA UART+ULSR

21480 CHECKINT LDA UART+IIR

21481 LSR:BCC INTR:;JSR NOBYT:NOP:NOP:NOP

21482 CLC

21483 IRQE PHP:LDA UART+IER:BEQ NBYT

21484 LDA UART+ULSR:AND #$40:BEQ NBYT

21485 JSR TX2:;JSR NOBYT:NOP:NOP

21486 NBYT PLP:RTS

21487 .GOTO 21710

21500 ;----

21510 TXA:AND #%00001000:BEQ SI3

21520 LDA ACIA:LDY SERI2:STA ($F7),Y

21530 INY:LDA SERST

21540 CPY SERI1:BNE SI2

21550 ORA #4:STA SERST

21560 SI2 STY SERI2

21570 ;----

21580 LDA $0294:AND #1:BEQ SI3

21590 LDA SERI1:SEC:SBC SERI2;=FREI

21600 CMP #$40:BCS SI3; MEHR ALS 1/4

21605 .IF MIKE:.GOTO 21615

21610 LDA ACIA+2:AND #$F3:STA ACIA+2

21612 .GOTO 21620

21615 LDA SERTS:ORA #RTSB:STA SERTS

21620 ;----

21630 SI3 TXA:AND #%00010000:BEQ SI6

21640 LDY SERO1:CPY SERO2:BEQ SI6

21650 LDA ($F9),Y:JMP SII

21660 ;----: JMP RSBASIN ;(*=F086)

21670 SII STA ACIA:INY

21680 STY SERO1

21690 ;----

21700 SI6 LDA ACIA+1:RTS

21710 ;----

21720 RSIRQ

21730 JSR RSIR1:BCS RSIR3:JMP $EA81

21749 RSIR3 JSR $FFEA:JMP BLIRQ:;$EA34

21750 ;-------- CHKIN/CKOUT

21760 RSCHKIN STA $99:CLC:RTS

21765 JMP RSBASIN; $F086

21770 RSCKOUT STA $9A:CLC:RTS

21772 RX2 LDA UART+RBR

21775 LDY SERI2:STA ($F7),Y

21780 INY:LDA SERST

21781 CPY SERI1:BNE SI2

21782 ORA #4:JMP SI2A:NOP:RTS

21783 SI2A STA SERST:SI2 STY SERI2

21784 ;----

21785 LDA $0294:AND #1:BEQ SI3X

21786 LDA SERI1:SEC:SBC SERI2

21787 JMP RXX2

21788 SI3X RTS

21945 ;F0BD

21950 ;--------------------------------

21955 ;-------- NMIOUT ADRS

21960 *=$ED0E:NOP:NOP:NOP

21965 *=$F88A:NOP:NOP:NOP

21970 ;-------- NMI-EINSPRUNG LOESCHEN

21975 *=$FE54:NOP:NOP

21980 *=$FE72:JMP $FEB6

21985 ;-------- IRQ SETZEN

21990 *=$EA31:JMP RSIRQ

21995 ;********************************

22000 ;-------------------------------

22010 *=$E1E6:JSR LSP; LOAD/SAVE IM DIR

22020 *=$E1D9:LDX #8:LDY #1:JSR LSD

22030 *=$E5E7:JSR KEY; F-TASTEN

22040 *=$ECE7 ; SHIFT RUN/STOP

22050 .BYT "L","Ï",34,"*"

22060 *=$E44B:.WORD NEUBEF ;BASIC-

22061 *=$E451:.WORD GETAUS ;VEKTOREN

22062 *=$EC78:.BYT $84 ;CTRL INST

22063 *=$ECAB:.BYT $82 ;CTRL HOME

22064 *=$EC7A:.BYT $81 ;CTRL CRSR RIGHT

22099 ;--------------------------------

22100 *=$EEBB

22110 LSD JSR $FFBA:TSTBA LDA FLAG

22115 BPL LSP1:AND #15:STA $BA:RTS

22120 LSP JSR $0079:CMP #",":BEQ LSP1

22140 PLA:PLA:JMP $A8F8:LSP1 RTS

22150 KEY JSR $E5B4:BIT $9D:BPL LSP1

22155 BIT FLAG:BPL LSP1

22160 CMP #3:BNE KEY2

22170 CLR LDX #0:STX $C7:STX $D4

22180 STX $D8:BEQ LSP1

22190 KEY2 CMP #$81:BCC LSP1:BNE KEY3

22191 LDY $D5:INY:KL1 DEY:BMI KL2

22192 LDA ($D1),Y:CMP #" ":BEQ KL1

22193 KL2 STY $D3:CPY $D5:BEQ K3C

22194 INC $D3:BNE K3C

22200 KEY3 CMP #$82

22210 BNE KEY4:LDX #24:LDY #0:CLC

22211 JSR $FFF0:K3C JSR CLR:JMP K3

22220 KEY4 CMP #$84:BNE KEY5

22230 LDA #" ":LDY $D3:K4 CPY $D5

22231 BEQ K5:BCS K3C

22232 K5 STA ($D1),Y:INY:BNE K4

22240 KEY5 CMP #140:BEQ K8:BCS LSP1

22250 CMP #137:BEQ LSP1

22260 CMP #133:BCC LSP1

22270 SBC #133:TAY:LDX KEY1,Y:LDY #1

22280 K1 LDA KT,X:BEQ K2

22290 KTX STA $0276,Y:INY:INX:BNE K1

22300 K8 LDA #"@":STA $0277

22310 LDA FLAG:AND #15:EOR #1:ORA #"0"

22320 STA $0278:LDA #13:STA $0279

22325 LDY #3

22330 K2 STY $C6:K3 PLA:PLA:JMP $E5CD

22340 KEY1 .BYT 0,KT3-KT,KT5-KT,KT7-KT

22350 .BYT <-1,KT4-KT,KT6-KT

22360 KT  .ASC "LIST":.BYT 13,0

22370 KT3 .ASC "RUN:":.BYT 13,0

22380 KT5 .ASC "LOAD":.BYT 13,0

22390 KT7 .ASC ">$0":.BYT 13,0

22400 KT4 .ASC "_":.BYT 13,0

22410 KT6 .ASC "SAVE":.BYT 0

22440 GETAUS BIT FLAG:BMI GETOK

22441 JMP $AE86

22445 GETOK LDA #0:STA $0D

22450 JSR $0073:CMP #"$":BEQ GTA1

22460 CMP #"%":BEQ GTA2:JSR $0079

22470 JMP $AE8D

22480 GTA2 LDA #0:STA $63:STA $62

22490 GTA2A JSR $0073:BCS GTAE

22500 CMP #"2":BCS GTAERR

22510 LSR:ROL $63:ROL $62:BCC GTA2A

22520 GTAERR JMP $B248 ; ILL. QUANTITY

22530 GTA1 LDA #0:STA $62:GTA1A STA $63

22540 JSR $0073:SEC:SBC #"0"

22550 BCC GTAE:CMP #10:BCC GTA1O

22560 SBC #"A"-"9"-1:CMP #10:BCC GTAE

22570 CMP #16:BCS GTAERR

22580 GTA1O PHA:LDY #4:GTA3

22590 ASL $63:ROL $62:BCS GTAERR

22600 DEY:BNE GTA3:PLA:ORA $63

22610 JMP GTA1A

22620 GTAE LDX #$90:SEC:JSR $BC49

22630 JMP $0079

22810 ;F014

22990 ;--------------------------------

22999 ;--------------------------------

23000 *=$FE75:NB1F

23005 LDA #0:STA $90:LDA $BA:JSR $FFB1

23010 LDA $0201:CMP #"$":BNE NB1C

23015 LDA #$F0:.BYT $2C

23020 NB1C LDA #$FF:JSR $FF93

23025 LDA $90:BMI NBA1E

23030 LDY #0:NBA1A LDA $0201,Y:BEQ NB1E

23035 JSR $FFA8:INY:BNE NBA1A

23040 NB1E JSR $FFAE:LDA $90:BNE NBA1E

23045 LDA $BA:JSR $FFB4

23050 LDA $0201

23055 CMP #"$":JMP NB1G

23056 ;FFB6

23057 ;--------------------------------

23058 *=$FEC2

23060 NB1G BEQ NB1D:LDA #$FF

23063 JSR $FF96

23065 NB1B JSR $FFA5:JSR $E716:LDA $90

23070 BEQ NB1B:NBDE JSR $FFAB

23075 NBA1E PLA:PLA:JMP $E386

23085 NB1D LDA #$F0:JSR $FF96

23090 JSR $FFA5:JSR $FFA5

23095 NBDL JSR $FFA5:JSR $FFA5

23100 LDX $90:BNE EDL3

23105 JSR $FFA5:TAX:JSR $FFA5:JSR $BDCD

23110 EDL1 JSR $FFA5:LDX $90:BNE EDL2

23115 JSR $E716:CMP #0

23120 BNE EDL1

23125 EDL2 LDA #13:JSR $E716

23130 JSR $FFE4:BNE EDL3

23135 LDA $90:BEQ NBDL:EDL3 JSR $FFAB

23140 LDA $BA:JSR $FFB1:LDA #$E0

23145 JSR $FF93:JSR $FFAE:JMP NBA1E

23220 ;STA ACIA+1:NOP:NOP:NOP

23225 JMP $FF6E

23998 ;FF48

23999 ;******** KASSETTE LOESCHEN *****

24000 *=$F5F8: BCC $F5F1 ; SAVE

24010 *=$F4B6: BCC $F4AF ; LOAD

24020 *=$F38B: JMP $F713 ; OPEN

24030 *=$F2C8: JMP $F713 ; CLOSE

24040 *=$F26F: JMP $F713 ; CKOUT

24050 *=$F225: BNE $F26F ; CHKIN

24060 *=$F1E5: SEC:BCS $F1FD ; BSOUT

24070 *=$F179: SEC:RTS   ; BASIN

24999 ;******* PARALLELER IEC-BUS *****

25000 Z1 =$94:Z2 =$95:Z4 =$A3:Z3 =$0285

25010 B1 =$FE1C:B2 =$DC07:B3 =$DC0D

25020 B4 =$DC0F:B5 =TPI:B6 =TPI+1

25030 B7 =TPI+3:B8 =TPI+4

25040 C1 =B5:C2 =TPI+2:C3 =TPI+3

25050 C4 =B8:C5 =TPI+5

25100 *=$FDAB: JSR NINI

25105 *=$FD50: JMP NMINI

25110 *=$ED0E: JMP NTALK; UND LISTEN

25120 *=$EDBB: JMP NSECL

25130 *=$EDC9: JMP NSECT

25140 *=$EDDD: JMP NOUT:NOP

25150 *=$EDF0: JMP NUT

25160 *=$EE00: JMP NUL

25170 *=$EE13: JMP NIN

25180 *=$F281: JSR NATNHI

25200 *=$F72C

25205 NINI STA $DC00

25210 IECINI .IF MIKE-1:.GOTO 25219

25211 LDA #%00011100:STA C5

25212 LDA #0:STA C2:.GOTO 25220

25219 LDA C2:AND # 239:STA C2

25220 LDY # 0:STY C4:LDA # 58

25230 STA C1:LDA # 63:STA C3

25240 LDA C2:AND # 254:STA C2

25250 LDY # 255:L0 DEY :NOP

25260 BNE L0:LDA C2:ORA # 1

25270 STA C2:LDA # 57:STA C1

25280 JMP $FDAE:;RTS

25290 ;*****

25300 IECTALK ORA # 64:.BYT $2C

25310 IECLISTEN ORA # 32

25320 IECTL L1 PHA :LDA # 59:STA B7

25330 LDA # 255:STA B6:STA B8

25340 LDA # 250:STA B5:LDA Z1

25350 BPL L2:LDA B5:AND # 223

25360 STA B5:LDA Z2:JSR L7

25370 LDA Z1:AND # 127:STA Z1

25380 LDA B5:ORA # 32:STA B5

25390 L2 LDA B5:AND # 247:STA B5

25400 PLA :JMP L7:SECLISTEN JSR L7

25410 L3 LDA B5:ORA # 8:STA B5

25420 RTS

25430 SECTALK JSR L7:L4 LDA # 61

25440 AND B5:STA B5:LDA # 195

25450 STA B7:LDA # 0:STA B8

25460 BEQ L3:IECOUT PHA :LDA Z1

25470 BPL L5:LDA Z2:JSR L7

25480 LDA Z1:L5 ORA # 128:STA Z1

25490 PLA :STA Z2:CLC 

25500 RTS :UNTALK LDA # 95:BNE L6

25510 UNLISTEN LDA # 63:L6 JSR L1:JSR L4

25520 LDA # 253:ORA B5:STA B5:CLI

25530 RTS :L7 EOR # 255:STA B6

25540 LDA B5:ORA # 18:STA B5

25550 BIT B5:BVC L8:BPL L8

25560 LDA # 128:JSR B1:BNE L12

25570 L8 LDA B5:BPL L8:AND # 239

25580 STA B5:L9 JSR L18:L10 BIT B5

25590 BVS L11:LDA B3:AND # 2

25600 BEQ L10:LDA Z3:BMI L9

25610 LDA # 1:JSR B1:L11 LDA B5

25620 ORA # 16:STA B5:L12 LDA # 255

25630 STA B6:RTS :IECIN LDA B5

25640 AND # 189:ORA # 129:STA B5

25650 L13 JSR L18:L14 LDA B5:AND # 16

25660 BEQ L15:LDA B3:AND # 2

25670 BEQ L14:LDA Z3:BMI L13

25680 LDA # 2:JSR B1:LDA B5

25690 AND # 61:STA B5:LDA # 13

25700 CLC :RTS :L15 LDA B5

25710 AND # 127:STA B5:AND # 32

25720 BNE L16:LDA # 64:JSR B1

25730 L16 LDA B6:EOR # 255:PHA 

25740 LDA B5:ORA # 64:STA B5

25750 L17 LDA B5:AND # 16:BEQ L17

25760 LDA B5:AND # 191:STA B5

25770 PLA :CLC :RTS 

25780 L18 LDA # 255:STA B2:LDA # 17

25790 STA B4:LDA B3:RTS

25800 ;**** EINBINDUNG

25830 NTALK JSR SETDEV

25840 BIT MAP:BPL OTL:JMP IECTL

25850 OTL JSR $F0A4:JMP $ED11

25860 NSECL BIT MAP:BPL OSL:JMP SECLISTEN

25870 OSL JSR $ED36:JMP $EDBE

25880 NSECT BIT MAP:BPL OST:JMP SECTALK

25890 OST JSR $ED36:JMP $EDCC

25900 NOUT BIT MAP:BPL OOUT:JMP IECOUT

25910 OOUT BIT $94:BMI OOUT1:JMP $EDE1

25920 OOUT1 JMP $EDE6

25930 NUT BIT MAP:BPL OUT:JMP UNTALK

25940 OUT JSR $EE8E:JMP $EDF3

25950 NUL BIT MAP:BPL OUL:JMP UNLISTEN

25960 OUL JSR $ED11:JMP $EE03

25970 NIN BIT MAP:BPL OIN:JMP IECIN

25980 OIN SEI:LDA #0:JMP $EE16

25990 SETDEV PHA:STY Z4

26000 AND #15:SEC:SBC #4:BCC PIEC

26010 CMP #7:BCS SIEC1;PIEC:TAY

26020 LDA POT2,Y:LDY Z4:LSR Z4:AND MAP:BEQ PIEC

26030 SIEC1 LDA MAP:AND #127:SIEC STA MAP:PLA:RTS

26040 PIEC

26050 LDA MAP:ORA #128:BNE SIEC

26060 POT2 .BYT 1,2,4,8,$10,$20,$40

26070 NMINI LDA #0:TAY:JSR $FD53

26080 .IF MIKE:LDA #%10000001:.GOTO 26090

26085 LDA #%10000000

26090 STA MAP

26100 LDA #128:STA 650

26110 FRESET LDA #8+128:STA FLAG

26115 LDA #180:STA BLNK2:STA BLNKT

26116 .IF MIKE:LDA #50::.GOTO 26120

26117 LDA #0

26120 STA BLNK1:RTS

26200 NATNHI BIT MAP:BPL OAH:JMP L3

26210 OAH JMP $EDBE

26999 ;***** WAS NICHT MIT KASSETE GEHT

27000 NEUBEF BIT FLAG:BPL NEUEND

27005 JSR TSTBA:LDA $0200

27010 CMP #"@":BEQ NBA1:CMP #">"

27020 BEQ NBA1:CMP #"!":BEQ NBA2

27030 CMP #"_":BEQ SYSOFF

27035 NEUEND JMP $A57C

27040 NBA2 LDA #1:TAY:STA ($2B),Y

27050 JSR $A533:LDA $22:CLC:ADC #2

27060 STA $2D:LDA $23:ADC #0:STA $2E

27070 JSR $A663:JMP $E386

27080 NBA1 JSR $0073:BCC NBZ1:JMP NB1F

27090 NBZ1 JSR $B79E:TXA:AND #15

27100 ORA #128:.BYT $2C

27105 SYSOFF LDA #0

27110 NBA1EX STA FLAG:JMP NBA1E

27999 ;*******************************

28000 ;***** SCROLL-HALT

28005 PCX1=*:*=$E940

28010 EOR #%00100100:AND #%00100100

28020 BEQ $E956:JMP PCX1:NOP:NOP

28030 *=PCX1

28040 CMP #%00000100:BEQ S1;CTRL LANGSAM

28050 CMP #%00100000:BNE S2;CTRL/CBM STOP

28055 ;JSR TESTHCOPY;NUR CBM

28060 S0 JMP $E938:S1 JMP $E94B

28070 S2 LDA $DC01:CMP #$FF:BNE S2

28080 S3 LDA $DC01:AND #$20:BNE S3

28090 BEQ S0

28100 ;********************************

28105 .GOTO 28200

28110 TESTHCOPY LDA #$7F:STA $DC00

28120 HC1 LDA $DC01:CMP $DC01:BNE HC1

28130 AND #%00100010:BEQ HCOPY:CLC:RTS

28200 ;********************************

28210 LB0 =$B0:LB1 =LB0+1

28220 L028E =$028E

28230 HCDEV =4:HCSEC =7

28240 HCOPY ;INC 53280

28245 LDA #$20:BIT $D011; TEST HIRES

28250 BNE LC1AA

28260 LDA L028E:BMI LC1AA

28270 LDA #$80:STA L028E

28280 LDA $DD00; ADRESSE BERECHNEN

28290 LSR :LDA $D018

28300 AND #$70:ROR 

28310 TAX :LDA $DD00

28320 LSR :LSR 

28330 TXA :ROR 

28340 EOR #$C0:STA LB1; HIBYTE

28350 LDA #$00:STA LB0

28360 LDA #HCDEV:JSR $ED0C; LISTEN

28370 LDA #$60+HCSEC; SECLISTEN

28380 JSR $EDB9:LDA #13:JSR $EDDD

28390 LDX #25

28400 LC1E0 LDY #$00:LC1E2 LDA (LB0),Y

28410 AND #$7F:CMP #$40

28420 BCC LC1F2:CMP #$60

28430 BCC LC1F0:EOR #$40

28440 LC1F0 EOR #$80:LC1F2 CMP #$20

28450 BCS LC1F8:EOR #$40

28460 LC1F8 JSR $EDDD:INY

28470 CPY #$28:BCC LC1E2

28480 LDA #$0D:JSR $EDDD

28490 TYA :CLC 

28500 ADC LB0:STA LB0

28510 BCC LC22A

28520 INC LB1:LC22A DEX

28530 BNE LC1E0:JSR $EDFE; UNLISTEN

28540 JSR $EDFE

28550 LDA #$00:STA L028E

28560 LC1AA SEC:RTS

28599 ;*******************************

28600 PCX2=*:*=$EB76

28610 JMP HC2:*=PCX2

28620 HC2 CPX #4:BNE HCE

28630 LDA $CB:CMP #$39:BNE HCE

28640 BIT $C6:BPL HC:HCE JMP $EAE0

28650 HC LDA #<-1:STA $C6

28660 JSR HCOPY:LDA #0:STA $C6

28665 JMP $EB42

28666 ;*******************************

28670 BLIRQ :LDX BLNK1:BEQ BLXX

28675 LDX $D011:TXA:AND #%11101111

28680 LDY BLNK2:CPY #255:BEQ BLANK

28681 TXA:AND #%00010000:BNE BLXX

28684 TXA:LDX BC

28685 ORA #%00010000:.BYT $2C:BLANK LDX #0:STA $D011:STX 53280

28690 BLXX JMP $EA34

28699 ;*******************************

28700 PCX3=*:*=$EA98

28710 JMP BLNK:*=PCX3

28730 BLNK BEQ NOTPR

28740 TAY:LDA BLNKT:STA BLNK2

28750 JMP $EA9B

28760 NOTPR LDA BLNK1:BEQ BLE:DEC BLNK1

28770 BNE BLE:LDA #50:STA BLNK1

28780 LDA BLNK2:CMP #255:BEQ BLE:DEC BLNK2

28790 BLE JMP $EB26

28791 PCX4=*:*=$E716

28792 JMP BLS:*=PCX4

28793 BLS PHA:STA $D7:LDA BLNKT:STA BLNK2:JMP $E719

29990 ;******** LEERE BEREICHE LOESCHEN

29998 ;FCD1

30000 DIV .WORD -1, 2304, 1536, 1047

30001 .WORD 857, 768, 384, 192, 96

30002 .WORD 64, 48, 32, 24, 16, 12, 6

30100 RXX1 AND $7F:STA SERST:LDA ($F7),Y

30110 INC SERI1:PHA

30120 LDA $0294:AND #1:BEQ RSBI1

30130 LDA SERI1:SEC:SBC SERI2

30140 CMP #$C0:BCC RSBI1

30150 LDA UART+MCR:ORA #%00000010

30160 STA UART+MCR

30170 RSBI1 PLA:CLC:RTS

30200 RXX2 CMP #$40:BCS SI3;

30210 LDA UART+MCR:AND #%11111101

30220 STA UART+MCR

30230 SI3 RTS

30300 TX2 LDA UART+MSR:AND #%00110000

30310 CMP #%00110000:BNE TXRT

30320 LDX #15

30330 TXLOOP LDY SERO1:CPY SERO2

30340 BEQ SI6:LDA ($F9),Y

30350 STA UART+THR

30351 INY:STY SERO1

30355 DEX:BNE TXLOOP

30360 SI6:TXRT:NOBYT RTS

30400 RXX1A STA SERST:LDA #0:RTS

49999 ;*******************************

50000 .END

50010 END

50020 OPEN2,2,2,CHR$(6)+CHR$(16)

50030 GET#2,A$:PRINTA$;

50040 GETA$:PRINT#2,A$;

50050 A=ST:IF (AAND247) <>0 THEN PRINTA

50060 IF A$<>"_" THEN50030

50070 CLOSE2

